# Figures

(ref:figure1) Sample locations from the 2016 WCVI, 2016 WCHG research surveys and 2017 pilot study.  The sample locations of the salmon survey are unknown.

```{r figure1, fig.cap='(ref:figure1)',warning=FALSE, echo=FALSE, message=FALSE, error= FALSE, width=5.9, height=8.5, fig.align='center'}

    library(here)
    library(rgdal)
    library(ggfortify)

    png("C:/github/sablehead/figures/Figure1.png", units="px", width=1600, height=1800, res=150) # write png to file
    sql          <-   "select * from Head_Measurements_Report where SLAT > 0"  # head measurement data
    #pointdata    <-   GetSQLData(sql,"Sablefish")   # retrieve from seamount database
    #write.table(pointdata, file = paste(path,"figure1.csv",sep=''),row.names=FALSE, na="",col.names=TRUE,  sep=",") 
    #pointdata    <-  read.csv(paste(path,'figure1.csv',sep=''),header=T)  # read from csv
    
    #K.Holt: changed point data to use here function when reading
    #pointdata    <-read.csv(here("standalone", "figure1.csv"))
    pointdata    <-  read.csv(paste(path,'figure1.csv',sep=''),header=T)  # read from csv
    
    lon          <-   data.frame(pointdata$SLAT)
    lat          <-   data.frame(pointdata$SLON)
    spid         <-   data.frame(pointdata$SPECIMEN_ID)
    trip         <-   data.frame(pointdata$TRIP_ID)
    df           <-   as.data.frame(cbind(lon,lat,spid,trip))   # add year, lat, long, specimen_id to dataframe

    # add pilot survey coordinates for general fishing area
    a <- c(46.7093,-130.82812, 1, 338773 ) #  cobb
    b <- c(48.2828,-133.204, 2, 338773 )    #   eickelburg
    
    df           <-  rbind(df,a)
    df           <-  rbind(df,b)
    df           <-  df[df$pointdata.TRIP_ID !=0,]
   
    canada       <-   readOGR(dsn = "C:/github/sablehead/storage",layer ="awscntry_geo", verbose = FALSE)  # open shapefile   
    shapef_can   <-   fortify(canada)    # fortify for ggplot require.
    points_df    <-   fortify(df)
    
    seamounts    <-   readOGR(dsn = "C:/github/sablehead/storage",layer ="twoSeamounts_geo", verbose = FALSE)  # open shapefile
    seam_can     <-   fortify(seamounts)    # fortify for ggplot require.
    
    map          <-  ggplot() +
                     geom_polygon(data = shapef_can,  
                                  aes(x = long, y = lat, group = group), 
                                      fill="gray40",  
                                      size = .2) +
                     geom_polygon(data = seam_can, aes(x = long, y =  lat, group = group), 
                                  color = "lightgray", alpha = 0, linetype = 1)  +
                     geom_point(data =   points_df, aes(pointdata.SLON, pointdata.SLAT,  
                                                    fill=factor(pointdata.TRIP_ID),  size=0.7) , 
                                                          colour="lightgray", shape=21, size=5) + 
                     geom_text(aes(x =  -130.000, y = 46.7093, label = "Cobb"),
                                    alpha = 1,
                                    color = "grey40")  +
                     geom_text(aes(x =  -131.6040, y = 48.2828, label = "Eickelberg"),
                                    alpha = 1,
                                    color = "grey40")  +
                     theme_minimal()    +
                     guides(fill="none") + 
                     guides(size="none") + 
                     guides(fill=guide_legend(title="Trip")) +
                     xlab("Longitude") + ylab("Latitude") + 
                     theme(  text = element_text(size=20),
                             plot.title      = element_blank(),
                             legend.position = c(.29, 0.45),
                             legend.justification = c("right", "top"),
                             legend.box.just = "right",
                             legend.margin = margin(6, 6, 6, 6)
                          )   
   
    map_projected  <- map +   # reproject to make it look better
    coord_map()  +
    annotation_north_arrow(location = "bl", which_north = "true",  # north arrow
                           pad_x  = unit(1.0, "cm"),  
                           pad_y  = unit(2.5,  "cm"),
                           height = unit(2.5,  "cm"),
                          width  = unit(2.5,  "cm"),
                           style  = north_arrow_fancy_orienteering)
    
    map_projected        +
    annotation_scale(location = "bl",
                     pad_x = unit(0.5, "in"),  
                     pad_y = unit(0.3, "in"),
                     height = unit(0.5, "cm"),
                     width  = unit(5.95,"cm"),
                     text_cex = 1.0)   +
                     coord_sf(crs = 4326)  +
                     scale_fill_discrete(name = "Research Trip", 
                                         labels = c("WCVI", "WCHG","Seamount Pilot"))

    while (!is.null(dev.list()))  dev.off()
    img <-   paste('C:/github/sablehead/figures/Figure1.png',sep="")   # -- retrieve png 
            knitr::include_graphics(img)
 
```
```{r figure_data_fit_regression_male_female}
  
  #  fit the regression lines and get the prediction results separately for male, female and head measurements
  #  before putting in ggplot - very necessary 
     
     cranial.f                     <-  hdUj[hdUj$SPECIMEN_SEX_DESC=="FEMALE",]  # Upper jaw  length data
     cranial.f$n                   <-  length(cranial.f$HeadBarcode)                   # number of specimens 
     cranial.fit.outliers.f        <-  lm(Fork_Length ~ Upper_jaw_length, data=cranial.f)  # linear regression model         
     #plot(hd.fit.outliers, which = 1, pch=21) 
     cranial.fit.outliersummary.f  <-  summary(cranial.fit.outliers.f)                 # summary

     cranial.f$predicted           <-  predict(cranial.fit.outliers.f)   # save the predicted values
     cranial.f$residuals           <-  residuals(cranial.fit.outliers.f) # save the residual values

     cranial.m                     <-  hdUj[hdUj$SPECIMEN_SEX_DESC=="MALE",]  # snout length data
     cranial.m$n                   <-  length(cranial.m$HeadBarcode)                   # number of specimens 
     cranial.fit.outliers.m        <-  lm(Fork_Length ~ Upper_jaw_length, data=cranial.m)  # linear regression model 
     #plot(hd.fit.outliers, which = 1, pch=21) 
     cranial.fit.outliersummary.m  <-  summary(cranial.fit.outliers.m)                 # summary

     cranial.m$predicted           <-  predict(cranial.fit.outliers.m)   # save the predicted values
     cranial.m$residuals           <-  residuals(cranial.fit.outliers.m) # save the residual values

     cranial.uj  <-  rbind( cranial.f, cranial.m )
     names(cranial.uj)[6] <- "hlength" 

     cranial.f                     <-  hdEd[hdEd$SPECIMEN_SEX_DESC=="FEMALE",]  # Eye Diameter length data
     cranial.f$n                   <-  length(cranial.f$HeadBarcode)                   # number of specimens 
     cranial.fit.outliers.f        <-  lm(Fork_Length ~ Eye_Diameter, data=cranial.f)  # linear regression model 
     #plot(hd.fit.outliers, which = 1, pch=21) 
     cranial.fit.outliersummary.f  <-  summary(cranial.fit.outliers.f)                 # summary

     cranial.f$predicted           <-  predict(cranial.fit.outliers.f)   # save the predicted values
     cranial.f$residuals           <-  residuals(cranial.fit.outliers.f) # save the residual values

     cranial.m                     <-  hdEd[hdEd$SPECIMEN_SEX_DESC=="MALE",]  # snout length data
     cranial.m$n                   <-  length(cranial.m$HeadBarcode)                   # number of specimens 
     cranial.fit.outliers.m        <-  lm(Fork_Length ~ Eye_Diameter, data=cranial.m)  # linear regression model 
     #plot(hd.fit.outliers, which = 1, pch=21) 
     cranial.fit.outliersummary.m  <-  summary(cranial.fit.outliers.m)                 # summary

     cranial.m$predicted           <-  predict(cranial.fit.outliers.m)   # save the predicted values
     cranial.m$residuals           <-  residuals(cranial.fit.outliers.m) # save the residual values

     cranial.ed  <-  rbind( cranial.f, cranial.m )
     names(cranial.ed)[6] <- "hlength"

     cranial.f                     <-  hdId[hdId$SPECIMEN_SEX_DESC=="FEMALE",]  # InterOrbital distance data
     cranial.f$n                   <-  length(cranial.f$HeadBarcode)                   # number of specimens 
     cranial.fit.outliers.f        <-  lm(Fork_Length ~ InterOrbital_Distance, data=cranial.f)  # linear regression model 
     #plot(hd.fit.outliers, which = 1, pch=21) 
     cranial.fit.outliersummary.f  <-  summary(cranial.fit.outliers.f)                 # summary

     cranial.f$predicted           <-  predict(cranial.fit.outliers.f)   # save the predicted values
     cranial.f$residuals           <-  residuals(cranial.fit.outliers.f) # save the residual values

     cranial.m                     <-  hdId[hdId$SPECIMEN_SEX_DESC=="MALE",]  # snout length data
     cranial.m$n                   <-  length(cranial.m$HeadBarcode)                   # number of specimens 
     cranial.fit.outliers.m        <-  lm(Fork_Length ~ InterOrbital_Distance, data=cranial.m)  # linear regression model 
     #plot(hd.fit.outliers, which = 1, pch=21) 
     cranial.fit.outliersummary.m  <-  summary(cranial.fit.outliers.m)                 # summary

     cranial.m$predicted           <-  predict(cranial.fit.outliers.m)   # save the predicted values
     cranial.m$residuals           <-  residuals(cranial.fit.outliers.m) # save the residual values

     cranial.id  <-  rbind( cranial.f, cranial.m )
     names(cranial.id)[6] <- "hlength"

     cranial.f                     <-  hdSl[hdSl$SPECIMEN_SEX_DESC=="FEMALE",]         # Snout length data
     cranial.f$n                   <-  length(cranial.f$HeadBarcode)                   # number of specimens 
     cranial.fit.outliers.f        <-  lm(Fork_Length ~ Snout_length, data=cranial.f)  # linear regression model 
     #plot(hd.fit.outliers, which = 1, pch=21) 
     cranial.fit.outliersummary.f  <-  summary(cranial.fit.outliers.f)                 # summary

     cranial.f$predicted           <-  predict(cranial.fit.outliers.f)   # save the predicted values
     cranial.f$residuals           <-  residuals(cranial.fit.outliers.f) # save the residual values

     cranial.m                     <-  hdSl[hdSl$SPECIMEN_SEX_DESC=="MALE",]  # snout length data
     cranial.m$n                   <-  length(cranial.m$HeadBarcode)                   # number of specimens 
     cranial.fit.outliers.m        <-  lm(Fork_Length ~ Snout_length, data=cranial.m)  # linear regression model 
     #plot(hd.fit.outliers, which = 1, pch=21) 
     cranial.fit.outliersummary.m  <-  summary(cranial.fit.outliers.m)                 # summary

     cranial.m$predicted           <-  predict(cranial.fit.outliers.m)   # save the predicted values
     cranial.m$residuals           <-  residuals(cranial.fit.outliers.m) # save the residual values

     cranial.sl <-  rbind( cranial.f, cranial.m )
     names(cranial.sl)[6] <- "hlength"
     
     cranial.f                     <-  hdPop[hdPop$SPECIMEN_SEX_DESC=="FEMALE",]  # Postorbital_Preoperculum length data
     cranial.f$n                   <-  length(cranial.f$HeadBarcode)              # number of specimens 
     cranial.fit.outliers.f        <-  lm(Fork_Length ~ Postorbital_Preoperculum, data=cranial.f)  # linear regression model #plot(hd.fit.outliers, which = 1, pch=21) 
     cranial.fit.outliersummary.f  <-  summary(cranial.fit.outliers.f)         # summary

     cranial.f$predicted           <-  predict(cranial.fit.outliers.f)   # save the predicted values
     cranial.f$residuals           <-  residuals(cranial.fit.outliers.f) # save the residual values

     cranial.m                     <-  hdPop[hdPop$SPECIMEN_SEX_DESC=="MALE",]  # snout length data
     cranial.m$n                   <-  length(cranial.m$HeadBarcode)                   # number of specimens 
     cranial.fit.outliers.m        <-  lm(Fork_Length ~ Postorbital_Preoperculum, data=cranial.m)  # linear regression model #plot(hd.fit.outliers, which = 1, pch=21) 
     cranial.fit.outliersummary.m  <-  summary(cranial.fit.outliers.m)         # summary

     cranial.m$predicted           <-  predict(cranial.fit.outliers.m)   # save the predicted values
     cranial.m$residuals           <-  residuals(cranial.fit.outliers.m) # save the residual values

     cranial.pp <-  rbind( cranial.f, cranial.m )
     names(cranial.pp)[6] <- "hlength"

     cranial.f                     <-  hdPo[hdPo$SPECIMEN_SEX_DESC=="FEMALE",]  # Post orbital Head length data
     cranial.f$n                   <-  length(cranial.f$HeadBarcode)              # number of specimens 
     cranial.fit.outliers.f        <-  lm(Fork_Length ~ Post_orbital_Head_length, data=cranial.f)  # linear regression model #plot(hd.fit.outliers, which = 1, pch=21) 
     cranial.fit.outliersummary.f  <-  summary(cranial.fit.outliers.f)         # summary

     cranial.f$predicted           <-  predict(cranial.fit.outliers.f)   # save the predicted values
     cranial.f$residuals           <-  residuals(cranial.fit.outliers.f) # save the residual values

     cranial.m                     <-  hdPo[hdPo$SPECIMEN_SEX_DESC=="MALE",]  # snout length data
     cranial.m$n                   <-  length(cranial.m$HeadBarcode)                   # number of specimens 
     cranial.fit.outliers.m        <-  lm(Fork_Length ~ Post_orbital_Head_length, data=cranial.m)  # linear regression model #plot(hd.fit.outliers, which = 1, pch=21) 
     cranial.fit.outliersummary.m  <-  summary(cranial.fit.outliers.m)         # summary

     cranial.m$predicted           <-  predict(cranial.fit.outliers.m)   # save the predicted values
     cranial.m$residuals           <-  residuals(cranial.fit.outliers.m) # save the residual values

     cranial.po <-  rbind( cranial.f, cranial.m )
     names(cranial.po)[6] <- "hlength"

   
```
(ref:figure2) Relationship between cranial lengths (UJ, ED, ID) vs fork length in millimeters.  Predicted points represented by black circles, measured values colored by residual scale.

```{r figure2, fig.cap='(ref:figure2)', results='asis', out.width = "470px", fig.align='left'}
   
     png("C:/github/sablehead/figures/Figure2.png", units="px", 
         width=2300, height=2700, res=500) # write png to file

     library(viridis)
     
     cranial       <- rbind(cranial.uj,cranial.ed, cranial.id)  # facet wrap all 5 cranial measurements
     cranial$facet <- factor(cranial$measure, levels = c("UJ", "ED", "ID"))

     ggplot(cranial, aes(x = hlength, y = Fork_Length)) +
            scale_y_continuous(limits = c(200, 1200)) +
            ylab('Fork length (mm)') +
            xlab("Cranial dimension (mm)") + 
            geom_smooth(method = "lm",se = FALSE,color = "grey") +                          # plot regression slope
            geom_segment(aes(xend = hlength, yend = predicted), color= "black", size=0.15, alpha = .35) +  # lines
                              # color residuals https://drsimonj.svbtle.com/visualising-residuals
            geom_point(aes(color = abs(residuals), size = abs(residuals))) +                # residuals
            scale_size(range=c(0.1,0.9)) + 
            scale_color_gradient2(low = "grey", mid = "#1ebecd", high = "orange")  +   
            guides( size = FALSE) +
       
            geom_point(aes(y = predicted), shape = 20, size=0.25)     +    # plot predicted circles
       
                stat_regline_equation(label.x=85, label.y=450, aes(label = ..eq.label..), size=2.1, 
                                      label.x.npc = "right",
                                      label.y.npc = "bottom") +   # y = mx+b and r2 values added to plot
       
                stat_regline_equation(label.x=85, label.y = 350,  aes(label = ..rr.label..), size=2.1,
                                      label.x.npc = "right",
                                      label.y.npc = "bottom") +  # r square value
       
                stat_cor( aes(label = paste(
                      if_else(readr::parse_number(..p.label..) < 0.001,    # p value
                              "p<0.001", ..p.label..), sep = "~`,   `~")),
                               label.x=85,
                               label.y = 250, size=2.1,
                               label.x.npc = "right",
                               label.y.npc = "bottom")  +
                geom_text(size=2.0, aes(x=20,y=1140,label= paste0("n=",n)))  +
                
                facet_grid( facet ~ SPECIMEN_SEX_DESC) +   # facet wrap
       
                theme(legend.position=c(0.87,0.56),legend.key.size = unit(1.4, 'mm'),    # legend position
                      legend.text=element_text(size=6), legend.title = element_text(size=6)) +
                theme(legend.box = 'horizontal')  + 
                labs(color="residuals") + 
                      theme(strip.text.x = element_text(size=7),
                      strip.text.y = element_text(size=7),
                      strip.background = element_rect(size=0.25,colour="black", fill="lightgray")) +
                      theme(panel.border = element_rect(color = "black",
                                    fill = NA,
                                    size = 0.25)) +
                      theme(axis.title.y = element_text(size = 7), axis.title.x = element_text(size = 7) ) +
                      theme(axis.text = element_text(size = 6)) +
                      theme(panel.background = element_rect(fill = "white",
                                colour = "white",
                                size = 0.35, linetype = "solid"),  # control the grey lines
                                panel.grid.major = element_line(size = 0.125, linetype = 'solid',
                                colour = "grey"), 
                                panel.grid.minor = element_line(size = 0.125, linetype = 'solid',
                                colour = "grey"))

     while (!is.null(dev.list()))  dev.off()
     img <-   paste('C:/github/sablehead/figures/figure2.png',sep="")   # -- retrieve png 
              knitr::include_graphics(img)
     
```
(ref:figure3) Relationship between cranial lengths (SL, PP, PO) vs fork length in millimeters.    Predicted points represented by black circles, measured values colored by residual scale.

```{r figure3, fig.cap='(ref:figure3)', results='asis',  out.width = "470px", fig.align='left'}
   
     png("C:/github/sablehead/figures/Figure3.png", units="px", width=2300, height=2700, res=500) # write png to file
      
     cranial <- rbind(cranial.sl, cranial.pp, cranial.po)  # facet wrap all 3 cranial measurements
     cranial$facet = factor(cranial$measure, levels = c("SL","PP","PO"))
 
     ggplot(cranial, aes(x = hlength, y = Fork_Length)) +
            scale_y_continuous(limits = c(200, 1200)) +
            ylab('Fork length (mm)') +
            xlab("Cranial dimension (mm)") + 
            geom_smooth(method = "lm",se = FALSE,color = "grey") +                          # plot regression slope
            geom_segment(aes(xend = hlength, yend = predicted), color= "black", size=0.15, alpha = .35) +  # lines
                              # color residuals https://drsimonj.svbtle.com/visualising-residuals
            geom_point(aes(color = abs(residuals), size = abs(residuals))) +                # residuals
            scale_size(range=c(0.1,0.9)) + 
            scale_color_gradient2(low = "grey", mid = "#1ebecd", high = "orange")  +   
            guides( size = FALSE) +
       
            geom_point(aes(y = predicted), shape = 20, size=0.25)     +    # plot predicted circles
       
                stat_regline_equation(label.x=100, label.y=450, aes(label = ..eq.label..), size=2.1, 
                                      label.x.npc = "right",
                                      label.y.npc = "bottom") +   # y = mx+b and r2 values added to plot
       
                stat_regline_equation(label.x=100, label.y = 350,  aes(label = ..rr.label..), size=2.1,
                                      label.x.npc = "right",
                                      label.y.npc = "bottom") +  # r square value
       
                stat_cor( aes(label = paste(
                      if_else(readr::parse_number(..p.label..) < 0.001,    # p value
                              "p<0.001", ..p.label..), sep = "~`,   `~")),
                               label.x=100,
                               label.y = 250, size=2.1,
                               label.x.npc = "right",
                               label.y.npc = "bottom")  +
                geom_text(size=2.0, aes(x=20,y=1140,label= paste0("n=",n)))  +
                
                facet_grid( facet ~ SPECIMEN_SEX_DESC) +   # facet wrap
       
                theme(legend.position=c(0.87,0.56),legend.key.size = unit(1.4, 'mm'),    # legend position
                      legend.text=element_text(size=6), legend.title = element_text(size=6)) +
                theme(legend.box = 'horizontal')  + 
                labs(color="residuals") + 
                      theme(strip.text.x = element_text(size=7),
                      strip.text.y = element_text(size=7),
                      strip.background = element_rect(size=0.25,colour="black", fill="lightgray")) +
                      theme(panel.border = element_rect(color = "black",
                                    fill = NA,
                                    size = 0.25)) +
                      theme(axis.title.y = element_text(size = 7), axis.title.x = element_text(size = 7) ) +
                      theme(axis.text = element_text(size = 6)) +
                      theme(panel.background = element_rect(fill = "white",
                                colour = "white",
                                size = 0.35, linetype = "solid"),  # control the grey lines
                                panel.grid.major = element_line(size = 0.125, linetype = 'solid',
                                colour = "grey"), 
                                panel.grid.minor = element_line(size = 0.125, linetype = 'solid',
                                colour = "grey"))

     while (!is.null(dev.list()))  dev.off()
     img <-   paste('C:/github/sablehead/figures/figure3.png',sep="")   # -- retrieve png 
              knitr::include_graphics(img)
     
```

```{r figure4, fig.cap='(ref:figure4)', results='asis', width=4.0, height=3.5, fig.align='left'}

#(ref:figure4) Box plot of fork length measurements conducted by science technicians for all specimens and only legal #size specimens (>55cm) where gender assignments were in concordance or not (1 or 0) with DNA test results.


     png("C:/github/sablehead/figures/Figure4.png", units="px", width=2300, height=2700, res=500) # write png to file

     # using 2022 results via MGL
      DNA.data22 <- paste("SELECT 2022 as yr,dbo.Head_DNA_Report.DNA_VIAL_BARCODE, ",
                      "dbo.Head_DNA_Report.SPECIMEN_SEX_DESC, ",
                      "dbo.Head_DNA_Report.Y_X_proportion_based_genetic_sex_ID_2022,  ",
                      "dbo.Head_DNA_Report.Y_X_proportion_based_concordance_fisher_and_genetic_sex_ID_2022, ",
                      "dbo.Head_Measurements_Report.Fork_Length, ",
                      "CASE WHEN Fork_Length >= 550 THEN 'Legal' ELSE 'Sublegal' END AS Size, 'All specimens' as grp ",
                      "FROM  dbo.Head_DNA_Report INNER JOIN  ",
                      "dbo.Head_Measurements_Report ON dbo.Head_DNA_Report.SPECIMEN_ID =  ",
                      "dbo.Head_Measurements_Report.SPECIMEN_ID  ",
                      "WHERE  (dbo.Head_DNA_Report.Y_X_proportion_based_concordance_fisher_and_genetic_sex_ID_2022  ",
                      "IN('0','1')) ORDER BY dbo.Head_DNA_Report.DNA_VIAL_BARCODE", sep="")
     #DNA.2022  <- GetSQLData(DNA.data22,"Sablefish") 
     #write.table(DNA.2022, file = paste(path,"figure4.csv",sep=''),
     #          row.names=FALSE,na="",col.names=TRUE, sep=',')
     DNA.2022  <- read.csv(paste(path,'figure4.csv', sep=''), header=T)
     names(DNA.2022) <- c("DNAYear","vial","sampler_sex","DNA_sex",
                          "concordance","forkLength", "size", "grp")
     alln1 <- sum(DNA.2022$concordance)
     alln0 <- length(DNA.2022$vial) - sum(DNA.2022$concordance)  
     
     DNA.legal        <- DNA.2022[DNA.2022$size=="Legal",]  # only pull out the legal samples
     DNA.legal$grp    <- 'Legal size specimens'
     names(DNA.legal) <- c("DNAYear","vial","sampler_sex","DNA_sex",
                           "concordance","forkLength", "size", "grp")
     Sampler.Legal.percent <- (sum(DNA.legal$concordance)/length(DNA.legal$vial)) * 100
     n1 <- sum(DNA.legal$concordance)
     n0 <- length(DNA.legal$vial) - sum(DNA.legal$concordance)
     
     DNA.compare <- rbind(DNA.2022,DNA.legal)  # bind all with just legal size

     library(reshape2)
     DNA.melt  <- melt(DNA.compare[,c(-1,-2,-3,-4, -7)], id.vars=c("grp",  "forkLength"))
     names(DNA.melt) <- c("Group","forkLength","variable","concordance")
     #tail(DNA.melt)
 
     p <-   ggplot(DNA.melt, aes(as.factor(concordance), forkLength)) +
            geom_boxplot(aes(fill = Group)) + scale_fill_brewer() +
            xlab("DNA concordance") + ylab("fork length (mm)") 
     
     p +    theme(panel.border = element_rect(color = "black",
                                    fill = NA,
                                    size = 0.25)) +
            theme(panel.background = element_rect(fill = "white",
                                     size = 0.75, linetype = "solid")) +
            theme(legend.position = c(0.27, 0.85))+
            geom_text(aes(x = as.factor(0), y = 100, label = paste('n=',alln0,
                                                                   '     n=', n0, sep=""))) +
            geom_text(aes(x = as.factor(1), y = 100, label = paste('n=',alln1,
                                                                   '     n=', n1, sep="")))
    

     #while (!is.null(dev.list()))  dev.off()
     #img <-   paste('C:/github/sablehead/figures/figure4.png',sep="")   # -- retrieve png 
     #          knitr::include_graphics(img)

```

\clearpage

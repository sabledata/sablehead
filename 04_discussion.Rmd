# Discussion

## Identification of Preferred Head Cranial Dimension

Interorbital distance (L~ID~) is recommended as the most suitable cranial measurement for predicting Sablefish fork length in support of a head-only sampling program.  All cranial dimensions collected during the research investigation were found to be good predictors of Sablefish fork length (L~FL~) with resulting R^2^ values for male and female Sablefish >0.88.  However, L~ID~ was the only method to be ranked as 5 out of 5 for both ease of use and repeatability criteria. Furthermore, feedback from technicians who participated in both the experimental and fishery pilot studies indicated that L~ID~ was the preferred method due to its speed and repeatability. Technicians noted that measurement errors were more likely to occur when calipers were applied to soft tissues. Other errors were a result of the manner in which the Sablefish were handled before measurement, ie. the operculum was cut off.  The high scores for ease of use and repeatability of the L~ID~ method were mainly due to the placement of calipers on bone rather than soft tissue.

## Implementation of Head-Only Catch Sampling in 2018

A head-only program for obtaining biological samples from the commercial Sablefish fishery was adopted in 2018.  This was made possible by:
1) identification of a reliable method for predicting Sablefish fork length from interorbital distance,
2) successful development of a genetic protocol to audit at-sea sex determination by fishing crews, and
3) confirmation that 84% of at-sea sex determinations were accurate.

Routine biological sampling procedures were modified so that commercial fishers are now only returning head samples, rather than the entire fish (Appendix \@ref(app:third-appendix)).  Fishing vessels are requested to voluntarily collect samples at each 50,000 lbs catch increment for the vessel throughout the year (e.g., 50,000 lbs, 100,000 lbs, 150,000 lbs, etc), with each sample consisting of approximately 20 to 25 Sablefish. The established sampling protocol requires sampled fish to be collected from traps or skates spread along the string being sampled. For longline gear, this is achieved by sampling the first 5 fish from each skate until the target of 20 - 25 fish is reached, while for trap gear, a select number of traps are marked for sampling ahead of time and all fish within marked traps are sampled.  The tag-recovery Sablefish program was also modified so that fishers return heads and tags only (Appendix \@ref(app:fourth-appendix)). These changes have improved the ability to freeze, store and transport samples due to less requirement for storage space.

## Future Monitoring and Research Requirements

We recommend that a review of the head-only sample program be undertaken in 2024-2025 to better examine how sampling rates, length composition, and spatial distribution have changed compared to the previous sampling program. By this time, the sampling program will have been in place for at least 6 years. At least 6 years is recommended to allow for a couple years of adjustment to the new protocols, as well as to allow for some lags in at-shore sampling of heads due to the COVID-19 By 2024-25, fishers will have had sufficient time to adapt to the revised head-only protocols and interruptions caused by the Covid-19 pandemic should be resolved.  Further, collection and repeated direct measurements of round fish for fork length and cranial dimensions are recommended at regular intervals (3 years) to examine changes in size at age over time.

Differences were observed between fish sex assignments made by field technicians and those determined by genetic tests. Further research is advisable to address and reconcile this discrepancy, which could be considered as part of the recommended review in 2023-2024.  For the genetic testing, this could involve additional optimization to improve the accuracy of the test. Regarding field sampling, it could involve conducting cross-comparison work among samplers/recorders to ensure consistency in sex assignments across different samplers.

Another recommendation would be to collect and repeat direct measurements of round fish for fork length and cranial dimensions at regular intervals (3 years) to look for any differences in size at age over time.

```{r figureComposition,  results='asis',  out.width = "410px", out.height = "400px",fig.align='left'}

    #However, our overall goals were also intended to expand spatial distribution of samples and increase the number of samples.  
    #Unfortunately, these goals were not met given sampling challenges caused by COVID restrictions that began in early 2020.  
    #Now that travel restrictions are being lifted we are hopeful that our sampling coverage will expand improving our overall data confidence.  
    
   
    #png("C:/github/sablehead/figures/FigureDiscussion.png", units="px", width=1600, height=1800, res=150) # write png to file

    # did we get bigger fish returned from the fishery after 2018 -- nope because of all the baby Sablefish that flooded the fishery
    #   Recruitment is one of the dominant processes regulating fish population productivity
     library(dplyr)
     samples  <- paste(" SELECT TRIP_SUB_TYPE_CODE, TRIP_SUB_TYPE_DESC, [trip year], fishing_year,   ",
                       " dbo.ll_SablefishingYearNo(fishing_year) AS fynum, ",
		                   " SPECIMEN_ID, SAMPLE_ID, SPECIMEN_SEX_CODE, Fork_Length, SPECIMEN_AGE  ",
		                   " FROM  dbo.GENERIC_GFBIO_COMMERCIAL_SPECIMENS_LWSMO  ",
		                   " WHERE (Fork_Length >0)  AND  ([trip year] > 2015)   ",
                       " AND (SPECIMEN_AGE IS NULL) " , sep='')  

    #specimens     <- GetSQLData(samples ,"Sablefish")
    #write.table( specimens, file = paste(path,"discussion_CommSpecimensCY.csv",sep=''),row.names=FALSE, na="",col.names=TRUE, sep=",")
    specimens     <-  read.csv(paste(path,"discussion_CommSpecimensCY.csv", sep=''), header=T) # read from csv
    # print(head(specimens))
    specimens  <- specimens %>%  mutate(GR = ifelse(fishing_year %in% c('FY 2016/2017','FY 2017/2018'), 1, 2))
    
    specimens.before  <-  specimens[specimens$GR==1,]
    a                 <-  specimens.before[specimens.before$Fork_Length>=550,]
    legal.before      <-  length(a$Fork_Length)/length(specimens.before$Fork_Length)  # 44%  count of big fish/ total fish pre2018 
        
    specimens.after   <-  specimens[specimens$GR==2,]
    b  <- specimens.after[specimens.after$Fork_Length>=550,]
    legal.after<-  length(b$Fork_Length)/length(specimens.after$Fork_Length)   # 13% count of big fish/ total fish post 2108

    #unique(specimens$fishing_year)   # indicates the fishing years
    #print(legal.before)
    #print(legal.after)
    
      gear.samples  <- paste(" SELECT  TRIP_SUB_TYPE_CODE, TRIP_SUB_TYPE_DESC, [trip year], fishing_year, ",
                             " dbo.ll_SableFishingYearNo(fishing_year) AS fynum, SPECIMEN_ID, SAMPLE_ID, ",
                             " SPECIMEN_SEX_CODE, Fork_Length, SPECIMEN_AGE,  GEAR_DESC ",
                             " FROM  dbo.GENERIC_GFBIO_COMMERCIAL_SPECIMENS_LWSMO ",
                             " WHERE  (Fork_Length > 0) AND ([trip year] > 2015)" , sep='')  

    #gear.specimens     <- GetSQLData(gear.samples ,"Sablefish")
    #write.table( gear.specimens, file = paste(path,"discussion_GearCommSpecimensCY.csv",sep=''),row.names=FALSE, na="",col.names=TRUE, sep=",")
    gear.specimens     <-  read.csv(paste(path,"discussion_GearCommSpecimensCY.csv", sep=''), header=T) # read from csv
    #print(head(gear.specimens))
    
     # sex in(1,2) only  for calendar years, 2020 only has 6 so left out  
     gear.fishery <- gear.specimens[gear.specimens$SPECIMEN_SEX_CODE %in% c(1,2) & gear.specimens$trip.year != 2020,]
                           # previous query: all fishing years Levels: FY 2016/2017 FY 2017/2018 FY 2018/2019 FY 2019/2020
                           # & gear.specimens$fynum %in% c(12,13,14,15),]

     # group data into 5 cm intervals    
     gear.fishery <- gear.fishery %>% mutate(lengthcm = 
			         cut(Fork_Length/10, breaks=seq(0, 100,by=5)))  
     names(gear.fishery)  <- c("TRIP_SUB_TYPE_CODE" ,"TRIP_SUB_TYPE_DESC" ,"trip.year" ,  "fishing_year" , "fynum"  ,
                               "SPECIMEN_ID" ,  "SAMPLE_ID" , "sex" , "Fork_Length" ,  "SPECIMEN_AGE" ,
                               "GEAR_DESC" , "lengthcm"  )
   
   library(plyr)  # mean, standard deviation and count
   df.text<-ddply( gear.fishery,.(trip.year, sex),summarise,
                                   mean.value= round(mean(Fork_Length)/10,1) ,
                                   stdev.value =  round(sd(Fork_Length)/10,1)   , 
                                   count.value = length(SPECIMEN_ID))
 

   p <- ggplot( gear.fishery, aes(x = lengthcm)) +
         #ggtitle("commercial length composition") +
         geom_histogram(aes(color = as.factor(sex),
                 	                     fill = as.factor(sex)), 
                 	                     stat="count",  position = "identity",alpha = 0.3)     +
                                       scale_fill_manual(values = c("#00AFBB", "#E7B800")) +
                                       scale_color_manual(values = c("#00AFBB", "#E7B800")) +
        geom_vline(xintercept = 5.5, col="red",  linetype="dashed")  +
        theme(axis.text.x = element_text(angle = 90)) 

   p2<-p + facet_wrap(~trip.year) + 
        geom_text(data=df.text,aes(label=paste(" n=",count.value), 
                                  color = as.factor(sex), x=-Inf,y=Inf), 
                                  size = 2.5, hjust=-0.1, vjust=c(6,8,6,8,6,8,6,8)) +
        geom_text(data=df.text,aes(label = paste("mean=", mean.value ) , 
                                  color = as.factor(sex), x=-Inf,y=Inf), 
                                  size = 2.5, hjust=-0.9, vjust=c(6,8,6,8,6,8,6,8))   +
        geom_text(data=df.text,aes(label=paste("SD=", stdev.value ), 
                                  color = as.factor(sex), x=-Inf,y=Inf), 
                                  size = 2.5, hjust=-2.9, vjust=c(6,8,6,8,6,8,6,8) )
   
    # while (!is.null(dev.list()))  dev.off()
    # img <-   paste('C:/github/sablehead/figures/figureDiscussion.png',sep="")   # -- retrieve png 
    #          knitr::include_graphics(img)
    

```

# Acknowledgments

We would like to express our gratitude to Schon Acheson and Kristina Castle for their valuable technical expertise contributed to this report. Furthermore, we extend our thanks to Mike Wetklo and Gordon Skocic from the Molecular Genetics Laboratory at PBS for their efforts in developing the Sablefish DNA gender tests.  We also appreciate the thorough review of this document by [Insert Names of Reviewers]. 

Special recognition goes to the crew of the F/V Pacific Viking for their participation in the pilot project. Lastly, we would like to acknowledge the Canadian Sablefish Association for their ongoing support of scientific research through the Science Rewards Program.  

\clearpage
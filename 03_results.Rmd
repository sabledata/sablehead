# Results

```{r fishData}

    fish         <-   read.csv(paste(path,"index_head_measurements.csv",sep=""), header = T)  # master data
    males        <-   fish[which(fish$SPECIMEN_SEX_DESC=='MALE'),]
    count.males  <-   length(males$SPECIMEN_ID)
    females      <-   fish[which(fish$SPECIMEN_SEX_DESC=='FEMALE'),]
    count.females<-   length(females$SPECIMEN_ID)
    fish.min     <-   min(fish$Fork_Length)
    fish.max     <-   max(fish$Fork_Length)
    fish.avg     <-   mean(fish$Fork_Length)
    
```

```{r head.stats}

    hd                     <-  hdUj[hdUj$SPECIMEN_SEX_DESC=='FEMALE',]  # UPPER JAW: female table of sample size, 
                                                                        # mean and sd for variables
    sex                    <-  'female'
    fl.nme                 <-  "Fork length"
    n                      <-  length(hd$SPECIMEN_ID)                   
    mn                     <-  round(mean(hd$Upper_jaw_length),1)
    mnfl                   <-  round(mean(hd$Fork_Length),1)
    std                    <-  round(sd(hd$Upper_jaw_length),2)
    stdfl                  <-  round(sd(hd$Fork_Length),2)
    slope                  <-  round(lmslp(lm(Fork_Length ~ Upper_jaw_length, data=hd)),1)
    se                     <-  round(coef(summary(lm(Fork_Length ~ Upper_jaw_length, data=hd)))[,"Std. Error"][2],2)  
                           # se should be one more decimal place than for what they are computed for
    r2                     <-  format(summary(lm(Fork_Length ~ Upper_jaw_length, data=hd))$r.squared,  digits = 3)    
    r                      <-  format(cor(hd$Upper_jaw_length,hd$Fork_Length),  digits = 3) 
    measurement            <-  "UJ"
    name                   <-  "upper jaw length"
    mf.uj                  <-  lm(Fork_Length ~ Upper_jaw_length, data=hd)
    
    
    head.stats <- data.frame(measurement = character(),
                             sex = character(),
                             n     = integer(),
                             slope = double(),
                             se    = double(),
                             r2    = double(),
                             r     = double(),
                             mn    = double(), 
                             std   = double(),
                             mnfl  = double(),
                             stdfl = double(),
                             name  = character(),
                             stringsAsFactors = FALSE)
    
    head.stats[1,]    <-  c(measurement,sex, n, slope, se, r2, r, mn, std,  mnfl, stdfl, name )
    
    hd                     <-  hdUj[hdUj$SPECIMEN_SEX_DESC=='MALE',]          #UPPER JAW: male table of sample size, mean and sd for variables
    sex                    <-  'male'
    n                      <-  length(hd$SPECIMEN_ID)                   
    mn                     <-  round(mean(hd$Upper_jaw_length),1)
    mnfl                   <-  round(mean(hd$Fork_Length),1)
    std                    <-  round(sd(hd$Upper_jaw_length),2)
    stdfl                  <-  round(sd(hd$Fork_Length),2)
    mm.uj                  <-  lm(Fork_Length ~ Upper_jaw_length, data=hd)
    
    head.stats[2,] <- c("UJ", sex, n,
                       slope=round(lmslp(lm(Fork_Length ~ Upper_jaw_length, data=hd)),1),
                       se=round(coef(summary(lm(Fork_Length ~ Upper_jaw_length, data=hd)))[, "Std. Error"][2],2),
                       r2=format(summary(lm(Fork_Length ~ Upper_jaw_length, data=hd))$r.squared,  digits = 3),
                       r=format(cor(hd$Upper_jaw_length,hd$Fork_Length),  digits = 3), 
                       mn, std,  mnfl, stdfl,"upper jaw length")
    
    head.stats$measurement  <- as.character(head.stats$measurement)
    #typeof(head.stats$measurement)
    
    hd                     <-  hdEd[hdEd$SPECIMEN_SEX_DESC=='FEMALE',]        #EYE DIAMETER: female table of sample size, mean and sd for variables
    sex                    <-  'female'
    n                      <-  length(hd$SPECIMEN_ID)                   
    mn                     <-  round(mean(hd$Eye_Diameter),1)
    mnfl                   <-  round(mean(hd$Fork_Length),1)
    std                    <-  round(sd(hd$Eye_Diameter),2)
    stdfl                  <-  round(sd(hd$Fork_Length),2)
    mf.ed                  <-  lm(Fork_Length ~ Eye_Diameter, data=hd)    
    
    head.stats[3,] <- c("ED", sex,n,
                       slope=round(lmslp(lm(Fork_Length ~ Eye_Diameter, data=hd)),1),
                       se=round(coef(summary(lm(Fork_Length ~ Eye_Diameter, data=hd)))[, "Std. Error"][2],2),
                       r2=format(summary(lm(Fork_Length ~ Eye_Diameter, data=hd))$r.squared,  digits = 3),
                       r=format(cor(hd$Eye_Diameter,hd$Fork_Length),  digits = 3), 
                       mn, std,  mnfl, stdfl, "eye diameter")
    
    hd                     <-  hdEd[hdEd$SPECIMEN_SEX_DESC=='MALE',]        #EYE DIAMETER: male table of sample size, mean and sd for variables
    sex                    <-  'male'
    n                      <-  length(hd$SPECIMEN_ID)                   
    mn                     <-  round(mean(hd$Eye_Diameter),1)
    mnfl                   <-  round(mean(hd$Fork_Length),1)
    std                    <-  round(sd(hd$Eye_Diameter),2)
    stdfl                  <-  round(sd(hd$Fork_Length),2)
    
    head.stats[4,] <- c("ED", sex,n,
                       slope=round(lmslp(lm(Fork_Length ~ Eye_Diameter, data=hd)),1),
                       se=round(coef(summary(lm(Fork_Length ~ Eye_Diameter, data=hd)))[, "Std. Error"][2],2),
                       r2=format(summary(lm(Fork_Length ~ Eye_Diameter, data=hd))$r.squared,  digits = 3),
                       r=format(cor(hd$Eye_Diameter,hd$Fork_Length),  digits = 3), 
                       mn, std,  mnfl, stdfl, "eye diameter")  

  
    
    hd                     <-  hdId[hdId$SPECIMEN_SEX_DESC=='FEMALE',]      # INTERORBITAL DISTANCE: female table of sample size, mean and sd for variables
    sex                    <-  'female'
    n                      <-  length(hd$SPECIMEN_ID)                   
    mn                     <-  round(mean(hd$InterOrbital_Distance),1)
    mnfl                   <-  round(mean(hd$Fork_Length),1)
    std                    <-  round(sd(hd$InterOrbital_Distance),2)
    stdfl                  <-  round(sd(hd$Fork_Length),2)
  
    head.stats[5,] <- c("ID", sex,n,
                       slope=round(lmslp(lm(Fork_Length ~ InterOrbital_Distance, data=hd)),1),
                       se=round(coef(summary(lm(Fork_Length ~ InterOrbital_Distance, data=hd)))[, "Std. Error"][2],2),
                       r2= format(summary(lm(Fork_Length ~ InterOrbital_Distance, data=hd))$r.squared,  digits = 2),
                       r=format(cor(hd$InterOrbital_Distance,hd$Fork_Length),  digits = 2), 
                       mn, std,  mnfl, stdfl,"interorbital distance")
    
    hd                     <-  hdId[hdId$SPECIMEN_SEX_DESC=='MALE',]       # INTERORBITAL DISTANCE: male table of sample size, mean and sd for variables
    sex                    <-  'male'
    n                      <-  length(hd$SPECIMEN_ID)                   
    mn                     <-  round(mean(hd$InterOrbital_Distance),1)
    mnfl                   <-  round(mean(hd$Fork_Length),1)
    std                    <-  round(sd(hd$InterOrbital_Distance),2)
    stdfl                  <-  round(sd(hd$Fork_Length),2)
  
    head.stats[6,] <- c("ID", sex,n,
                       slope=round(lmslp(lm(Fork_Length ~ InterOrbital_Distance, data=hd)),1),
                       se=round(coef(summary(lm(Fork_Length ~ InterOrbital_Distance, data=hd)))[, "Std. Error"][2],2),
                       r2= format(summary(lm(Fork_Length ~ InterOrbital_Distance, data=hd))$r.squared,  digits = 3),
                       r=format(cor(hd$InterOrbital_Distance,hd$Fork_Length),  digits = 3),
                       mn, std,  mnfl, stdfl,"interorbital distance")
    
    
    hd                     <-  hdSl[hdSl$SPECIMEN_SEX_DESC=='FEMALE',]     # SNOUT LENGTH: female table of sample size, mean and sd for variables
    sex                    <-  'female'
    n                      <-  length(hd$SPECIMEN_ID)                   
    mn                     <-  round(mean(hd$Snout_length),1)
    mnfl                   <-  round(mean(hd$Fork_Length),1)
    std                    <-  round(sd(hd$Snout_length),2)
    stdfl                  <-  round(sd(hd$Fork_Length),2)
  
    head.stats[7,] <-c("SL", sex,n,
                      slope=round(lmslp(lm(Fork_Length ~ Snout_length, data=hd)),1),
                      se=round(coef(summary(lm(Fork_Length ~ Snout_length, data=hd)))[, "Std. Error"][2],2),
                      r2= format(summary(lm(Fork_Length ~ Snout_length, data=hd))$r.squared,  digits = 3),
                      r=format(cor(hd$Snout_length,hd$Fork_Length),  digits = 3),
                      mn, std,  mnfl, stdfl,"snout length")
    
    hd                     <-  hdSl[hdSl$SPECIMEN_SEX_DESC=='MALE',]     # SNOUT LENGTH: male table of sample size, mean and sd for variables
    sex                    <-  'male'
    n                      <-  length(hd$SPECIMEN_ID)                   
    mn                     <-  round(mean(hd$Snout_length),1)
    mnfl                   <-  round(mean(hd$Fork_Length),1)
    std                    <-  round(sd(hd$Snout_length),2)
    stdfl                  <-  round(sd(hd$Fork_Length),2)
  
    head.stats[8,] <-c("SL", sex,n,
                      slope=round(lmslp(lm(Fork_Length ~ Snout_length, data=hd)),1),
                      se=round(coef(summary(lm(Fork_Length ~ Snout_length, data=hd)))[, "Std. Error"][2],2),
                      r2= format(summary(lm(Fork_Length ~ Snout_length, data=hd))$r.squared,  digits = 3),
                      r=format(cor(hd$Snout_length,hd$Fork_Length),  digits = 3),
                      mn, std,  mnfl, stdfl, "snout length")
    
    hd                     <-  hdPop[hdPop$SPECIMEN_SEX_DESC=='FEMALE',]    #POSTORBITAL PREOPERCULUM: female table of sample size, mean and sd for variables
    sex                    <-  'female'
    n                      <-  length(hd$SPECIMEN_ID)                   
    mn                     <-  round(mean(hd$Postorbital_Preoperculum),1)
    mnfl                   <-  round(mean(hd$Fork_Length),1)
    std                    <-  round(sd(hd$Postorbital_Preoperculum),2)
    stdfl                  <-  round(sd(hd$Fork_Length),2)

    head.stats[9,] <- c("PP",sex,n,
                       slope=round(lmslp(lm(Fork_Length ~ Postorbital_Preoperculum, data=hd)),1),
                       se=round(coef(summary(lm(Fork_Length ~ Postorbital_Preoperculum, data=hd)))[, "Std. Error"][2],2),
                       r2=format(summary(lm(Fork_Length ~ Postorbital_Preoperculum, data=hd))$r.squared,  digits = 3),
                       r=format(cor(hd$Postorbital_Preoperculum,hd$Fork_Length),  digits = 3),
                       mn, std,  mnfl, stdfl,"postorbital preoperculum length")

    hd                     <-  hdPop[hdPop$SPECIMEN_SEX_DESC=='MALE',]    #POSTORBITAL PREOPERCULUM: male table of sample size, mean and sd for variables
    sex                    <-  'male'
    n                      <-  length(hd$SPECIMEN_ID)                   
    mn                     <-  round(mean(hd$Postorbital_Preoperculum),1)
    mnfl                   <-  round(mean(hd$Fork_Length),1)
    std                    <-  round(sd(hd$Postorbital_Preoperculum),2)
    stdfl                  <-  round(sd(hd$Fork_Length),2)

    head.stats[10,] <- c("PP",sex,n,
                       slope=round(lmslp(lm(Fork_Length ~ Postorbital_Preoperculum, data=hd)),1),
                       se=round(coef(summary(lm(Fork_Length ~ Postorbital_Preoperculum, data=hd)))[, "Std. Error"][2],2),
                       r2=format(summary(lm(Fork_Length ~ Postorbital_Preoperculum, data=hd))$r.squared,  digits = 3),
                       r=format(cor(hd$Postorbital_Preoperculum,hd$Fork_Length),  digits = 3),
                       mn, std,  mnfl, stdfl,"postorbital preoperculum length")  
    
    hd                     <-  hdPo[hdPo$SPECIMEN_SEX_DESC=='FEMALE',]    #POSTORBITAL HEAD LENGTH: female table of sample size, mean and sd for variables
    sex                    <-  'female'
    n                      <-  length(hd$SPECIMEN_ID)                   
    mn                     <-  round(mean(hd$Post_orbital_Head_length),1)
    mnfl                   <-  round(mean(hd$Fork_Length),1)
    std                    <-  round(sd(hd$Post_orbital_Head_length),2)
    stdfl                  <-  round(sd(hd$Fork_Length),2)

    head.stats[11,] <- c("PO",sex,n,
                       slope=round(lmslp(lm(Fork_Length ~ Post_orbital_Head_length, data=hd)),1),
                       se=round(coef(summary(lm(Fork_Length ~ Post_orbital_Head_length, data=hd)))[, "Std. Error"][2],2),
                       r2=format(summary(lm(Fork_Length ~ Post_orbital_Head_length, data=hd))$r.squared,  digits = 3),
                       r=format(cor(hd$Post_orbital_Head_length,hd$Fork_Length),  digits = 3),
                       mn, std,  mnfl, stdfl, "postorbital head length")

    hd                     <-  hdPo[hdPo$SPECIMEN_SEX_DESC=='MALE',]    #POSTORBITAL HEAD LENGTH: male table of sample size, mean and sd for variables
    sex                    <-  'male'
    n                      <-  length(hd$SPECIMEN_ID)                   
    mn                     <-  round(mean(hd$Post_orbital_Head_length),1)
    mnfl                   <-  round(mean(hd$Fork_Length),1)
    std                    <-  round(sd(hd$Post_orbital_Head_length),2)
    stdfl                  <-  round(sd(hd$Fork_Length),2)

    head.stats[12,] <- c("PO",sex,n,
                       slope=round(lmslp(lm(Fork_Length ~ Post_orbital_Head_length, data=hd)),1),
                       se=round(coef(summary(lm(Fork_Length ~ Post_orbital_Head_length, data=hd)))[, "Std. Error"][2],2),
                       r2=format(summary(lm(Fork_Length ~ Post_orbital_Head_length, data=hd))$r.squared,  digits = 3),
                       r=format(cor(hd$Post_orbital_Head_length,hd$Fork_Length),  digits = 3),
                       mn, std,  mnfl, stdfl, "postorbital head length") 
    
    top.fish        <- head.stats %>% group_by(sex) %>% slice_max(order_by = r, n = 2)   # get top 2 r  values male and female
    top.fish.rsq    <- head.stats %>% group_by(sex) %>% slice_max(order_by = r2, n = 2)   # get top 2 rsq  values male and female
 
```

##  Experimental Study 2016

A total of 438 specimens comprised of `r count.males` males and `r count.females` females from three different surveys were were evaluated for this study (Table \@ref(tab:table2)).  The post orbital head length (L~PO~) measurement had a lower number of measurements compared to other methods because it was abandoned after measuring 130 Sablefish due to technical issues.  The smallest fork length of the collected specimens was `r fish.min` mm, the largest was `r fish.max` mm, and the average was `r round(fish.avg,1)` mm.  This range of sizes is broadly representative of those found in the fishery and survey.


<!--
Table \@ref(tab:table3) lists the statistics of the cranial dimensions (L~UJ~, L~ED~, L~ID~, L~SL~, L~PP~, L~PO~) as predictors of the response variable fork length (L~FL~).  All cranial dimensions were highly correlated with fork length with high R-squared values and significant p-values (Figure \@ref(fig:figure2) and Figure \@ref(fig:figure3)).  

The correlation coefficient (r) was highest for female measurements of L~`r top.fish$measurement[1]`~ (`r top.fish$r[1]`) and  L~`r top.fish$measurement[2]`~ (`r top.fish$r[2]`) and male measurements of L~`r top.fish$measurement[3]`~ (`r top.fish$r[3]`) and  L~`r top.fish$measurement[4]`~ (`r top.fish$r[4]`).  The R-squared values were highest for female measurements of L~`r top.fish.rsq$measurement[1]`~ (`r top.fish.rsq$r2[1]`) and L~`r top.fish.rsq$measurement[2]`~ (`r top.fish.rsq$r2[2]`) and male measurements of L~`r top.fish.rsq$measurement[3]`~ (`r top.fish.rsq$r2[3]`) and  L~`r top.fish.rsq$measurement[4]`~ (`r top.fish.rsq$r2[4]`). 
-->

<!-- KH: have suggested replacing the above paragraph with the following two paragraphs to seperate out the correlations values from the linear regression analysis, and to show that p-values are from linear regressions (i.e., t-tests). This is to address Rob K.'s comments on this section -->

All cranial dimensions were highly correlated with fork length (Table \@ref(tab:table3)). The correlation coefficient (r) was highest for female measurements of L~`r top.fish$measurement[1]`~ (`r top.fish$r[1]`) and  L~`r top.fish$measurement[2]`~ (`r top.fish$r[2]`) and male measurements of L~`r top.fish$measurement[3]`~ (`r top.fish$r[3]`) and  L~`r top.fish$measurement[4]`~ (`r top.fish$r[4]`). 

Results from the individual linear regression analyses indicated that all six cranial dimensions were good predictors of fork length based on with high R-squared values and significant p-values (Table \@ref(tab:table3), Figures \@ref(fig:figure2) - \@ref(fig:figure3)). The R-squared values were highest for female measurements of L~`r top.fish.rsq$measurement[1]`~ (`r top.fish.rsq$r2[1]`) and L~`r top.fish.rsq$measurement[2]`~ (`r top.fish.rsq$r2[2]`) and male measurements of L~`r top.fish.rsq$measurement[3]`~ (`r top.fish.rsq$r2[3]`) and  L~`r top.fish.rsq$measurement[4]`~ (`r top.fish.rsq$r2[4]`).

In general, the samplers reported that measurement errors were more likely when the calipers were placed on soft tissues, rather than bone. The technicians scored interorbital distance (L~ID~) as the highest on the five point scale for ease of use and repeatable criteria, and eye diameter (L~ED~) and postorbital head length (L~PO~) were scored as the lowest (Table \@ref(tab:table4)).  L~ID~ (narrowest distance between the eye sockets) proved the easiest measurement as the tissue could be easily compressed with the caliper jaws to obtain bone measurements.  L~ED~ (anterior-posterior diameter of eye socket) proved hard to repeat on soft tissue. L~PO~ (posterior inner edge of orbit to dorsal insertion of opercle) was difficult to measure since many opercula were damaged during head removal by J-cut, the endpoints were difficult to define and the electronic calipers malfunctioned with lengths >15 cm.

### Genetic sex-determination

Genomic DNA (129 of 137 fin clips) were successfully PCR amplified by the MGL using the methods described above to determine sex. The sexes as determined by the genetic tests were 88.4% (114/129) concordant with the sexes as assigned by the science technicians in the field.  The fork length ranges of 350-375 cm and 600-625 cm had the lowest concordance of 60% (Figure \@ref(fig:figure4)).

##  Fishery Pilot Study 2017

The 360 heads received from the commercial vessel were in good condition and operculum cuts worked well to indicate sex. The first 99 heads (`r count99[1]` from Cobb Seamount, `r count99[2]` from Eickelberg Seamount) were measured once by three experienced science technicians for each cranial dimension of L~UJ~, L~ID~, L~SL~ and L~PP~ (Table \@ref(tab:table5)).  <!--K.Holt; suggest replacing this sentence with the one below: The cranial measurements that produced the lowest mean errors were upper jaw (L~UJ~) and interorbital distance (L~ID~) with IAE values of `r IAE.UJ` % and `r IAE.ID` %, respectively (Table \@ref(tab:table5)).-->  The upper jaw measurement (L~UJ~) had the lowest mean error index followed closely by interorbital distance and snout length (L~SL~; Table \@ref(tab:table5)).  Post orbital to preoperculum distance (L~PP~) was less precise, with an IAE value that was approximately double those of the other three dimensions.  

Genomic DNA (80 of 99 fin clips collected) were successfully PCR amplified.  Fish sex, as assigned by the molecular genetics test were concordant with 83.8% (67/80) of the sexes as assigned by the commercial fishers. Agreement of sex assigned by molecular genetics and fishers were lowest for fish with an average interorbital length range of 43-44 mm (Figure \@ref(fig:figure5)). 
